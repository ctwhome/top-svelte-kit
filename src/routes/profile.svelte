<script context="module" lang="ts"
        ✂prettier:content✂="CiAgaW1wb3J0IHtBUElfQVVUSCwgUk9VVEVfSE9NRX0gZnJvbSAnJGxpYi9jb25zdGFudHMnCgogIGZ1bmN0aW9uIHJlc3BvbnNlKHVzZXIpIHsKICAgIGlmICh1c2VyICYmICF1c2VyLmd1ZXN0KSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgcHJvcHM6IHsKICAgICAgICAgIHVzZXIKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgcmVkaXJlY3Q6IFJPVVRFX0hPTUUsCiAgICAgICAgc3RhdHVzOiAzMDIKICAgICAgfQogICAgfQogIH0KCiAgZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvYWQoe2ZldGNoLCBzZXNzaW9ufSkgewogICAgLy8gQXBwcm9hY2ggIzEgLSBDYWxsIHRoZSBzZXNzaW9uIGdldHRlciBBUEkKICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKEFQSV9BVVRIKQogICAgaWYgKHJlcy5vaykgewogICAgICBjb25zdCB7dXNlcn0gPSBhd2FpdCByZXMuanNvbigpCiAgICAgIHJldHVybiByZXNwb25zZSh1c2VyKQogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBzdGF0dXM6IHJlcy5zdGF0dXMsCiAgICAgICAgZXJyb3I6IG5ldyBFcnJvcihgQ291bGQgbm90IGxvYWQgJHtBUElfQVVUSH1gKQogICAgICB9CiAgICB9CgogICAgLy8gQXBwcm9hY2ggIzIgLSBVc2UgdGhlIHNlc3Npb24gcGFyYW1ldGVyIChyZWZlciBob29rcy9pbmRleC50cyB0byBzZWUgaG93IGl0IGdvdCBwb3B1bGF0ZWQpCiAgICAvLyBjb25zdCB7IHVzZXIgfSA9IHNlc3Npb24KICAgIC8vIHJldHVybiByZXNwb25zZSh1c2VyKQogIH0K">{
}
</script>





<script lang="ts"
        ✂prettier:content✂="CiAgaW1wb3J0IHtvbk1vdW50fSBmcm9tICdzdmVsdGUnCiAgaW1wb3J0IHtDaHJvbWVJY29ufSBmcm9tICdzdmVsdGUtZmVhdGhlci1pY29ucycKICBpbXBvcnQgdHlwZSB7UHJvZmlsZUF0dHJzfSBmcm9tICckbGliL3VzZXInCiAgaW1wb3J0IHsKICAgIHNpZ25PdXQsCiAgICBnZXRDdXJyVXNlclByb2ZpbGUsCiAgICB1cGRDdXJyVXNlclByb2ZpbGUsCiAgICB1cGRDdXJyVXNlckF2YXRhciwKICAgIGdldEF2YXRhciwKICAgIHByb2ZpbGUKICB9IGZyb20gJyRsaWIvdXNlcicKICBpbXBvcnQge2hhbmRsZUFsZXJ0fSBmcm9tICckbGliL2FsZXJ0JwogIGltcG9ydCBTZW8gZnJvbSAnJGxpYi9jb21wb25lbnRzL1NFTy5zdmVsdGUnCiAgaW1wb3J0IE1vZGFsIGZyb20gJyRsaWIvY29tcG9uZW50cy9Nb2RhbC5zdmVsdGUnCiAgaW1wb3J0IEF2YXRhciBmcm9tICckbGliL2NvbXBvbmVudHMvQXZhdGFyLnN2ZWx0ZScKICBpbXBvcnQge1VSTF9ESUNFQkVBUn0gZnJvbSAnJGxpYi9jb25zdGFudHMnCgogIC8vIEFwcHJvYWNoICMzIChub24tZWZmZWN0aXZlKTogRW5hYmxlIHdoZW4gdXNpbmcgY2xpZW50LXNpZGUgdXNlciBzZXNzaW9uLiBJZiB5b3UncmUgcHVyZWx5IHVzaW5nIHRoZSBjbGllbnQtc2lkZSBzdXBhYmFzZS1tYWludGFpbmVkIHNlc3Npb24gY29tbWVudCBvdXQgdGhlIGFwcHJvYWNoICMxLiBUaGVyZSB3b3VsZCBiZSBhIGZsYXNoIG9mIHVuc3R5bGVkIGNvbnRlbnQgdGhvCiAgLy8gaW1wb3J0IHsgYnJvd3NlciB9IGZyb20gJyRhcHAvZW52JzsKICAvLyBpbXBvcnQgeyB1c2VyIH0gZnJvbSAnJGxpYi91c2VyJwogIC8vIGlmKGJyb3dzZXIgJiYgISR1c2VyKSBnb3RvKCcvJykKCiAgbGV0IGxvYWRpbmcgPSBmYWxzZQogIGxldCBwcm9maWxlU3RhdGU6IFByb2ZpbGVBdHRycyA9IHsKICAgIHVzZXJuYW1lOiAnJywKICAgIHdlYnNpdGU6ICcnLAogICAgYXZhdGFyX3VybDogJycKICB9CgogIGFzeW5jIGZ1bmN0aW9uIGdldFByb2ZpbGUoKSB7CiAgICB0cnkgewogICAgICBsb2FkaW5nID0gdHJ1ZQogICAgICBsZXQgewogICAgICAgIGRhdGE6IHt1c2VybmFtZSwgd2Vic2l0ZSwgYXZhdGFyX3VybH0sCiAgICAgICAgZXJyb3IKICAgICAgfSA9IGF3YWl0IGdldEN1cnJVc2VyUHJvZmlsZSgpCiAgICAgIGlmIChlcnJvcikgewogICAgICAgIGhhbmRsZUFsZXJ0KHsKICAgICAgICAgIHR5cGU6ICdkZWZhdWx0JywKICAgICAgICAgIHRleHQ6ICdGaXJzdCBsb2dpbj8gWW91IHdhbm5hIHVwZGF0ZSB5b3VyIHByb2ZpbGUgZGV0YWlscz8g8J+ZgicKICAgICAgICB9KQogICAgICB9CgogICAgICBhdmF0YXJfdXJsID0gYXdhaXQgZ2V0QXZhdGFyKGF2YXRhcl91cmwpCiAgICAgIHByb2ZpbGVTdGF0ZSA9IHt1c2VybmFtZSwgd2Vic2l0ZSwgYXZhdGFyX3VybH0KICAgICAgcHJvZmlsZS5zZXQoey4uLnByb2ZpbGVTdGF0ZX0pCiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBUeXBlRXJyb3IpIHsKICAgICAgICBoYW5kbGVBbGVydCh7CiAgICAgICAgICB0eXBlOiAnZGVmYXVsdCcsCiAgICAgICAgICB0ZXh0OiAnRmlyc3QgbG9naW4/IFlvdSB3YW5uYSB1cGRhdGUgeW91ciBwcm9maWxlIGRldGFpbHM/IPCfmYInCiAgICAgICAgfSkKICAgICAgfSBlbHNlIGlmIChlcnJvci5tZXNzYWdlID09PSAnVGhlIHJlc291cmNlIHdhcyBub3QgZm91bmQnKSB7CiAgICAgICAgaGFuZGxlQWxlcnQoewogICAgICAgICAgdHlwZTogJ2RlZmF1bHQnLAogICAgICAgICAgdGV4dDoKICAgICAgICAgICAgJ1lvdSBrbm93PyBZb3UgY2FuIGNsaWNrIG9uIHRoZSByYW5kb21seSBnZW5lcmF0ZWQgYXZhdGFyIHRvIHVwZGF0ZSB5b3VyIHByb2ZpbGUgcGljdHVyZS4nCiAgICAgICAgfSkKICAgICAgfSBlbHNlIHsKICAgICAgICBoYW5kbGVBbGVydCh7dHlwZTogJ2Vycm9yJywgdGV4dDogZXJyb3IubWVzc2FnZX0pCiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIGxvYWRpbmcgPSBmYWxzZQogICAgfQogIH0KCiAgYXN5bmMgZnVuY3Rpb24gdXBkUHJvZmlsZSgpIHsKICAgIHRyeSB7CiAgICAgIGxvYWRpbmcgPSB0cnVlCgogICAgICBsZXQgewogICAgICAgIGRhdGE6IFt7dXNlcm5hbWUsIHdlYnNpdGV9XSwKICAgICAgICBlcnJvcjogdXBkYXRlRXJyb3IKICAgICAgfSA9IGF3YWl0IHVwZEN1cnJVc2VyUHJvZmlsZSh7CiAgICAgICAgdXNlcm5hbWU6IHByb2ZpbGVTdGF0ZS51c2VybmFtZSwKICAgICAgICB3ZWJzaXRlOiBwcm9maWxlU3RhdGUud2Vic2l0ZQogICAgICB9KQogICAgICBpZiAodXBkYXRlRXJyb3IpIHsKICAgICAgICB0aHJvdyB1cGRhdGVFcnJvcgogICAgICB9CgogICAgICBwcm9maWxlLnVwZGF0ZSgocHJvZmlsZSkgPT4gKHsuLi5wcm9maWxlLCB1c2VybmFtZSwgd2Vic2l0ZX0pKQogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgaGFuZGxlQWxlcnQoe3R5cGU6ICdlcnJvcicsIHRleHQ6IGVycm9yLm1lc3NhZ2V9KQogICAgfSBmaW5hbGx5IHsKICAgICAgaXNNb2RhbE9wZW5lZCA9IGZhbHNlCiAgICAgIGxvYWRpbmcgPSBmYWxzZQogICAgfQogIH0KCiAgYXN5bmMgZnVuY3Rpb24gdXBkQXZhdGFyKGV2ZW50OiBhbnkpIHsKICAgIGNvbnN0IHt0YXJnZXR9ID0gZXZlbnQuZGV0YWlsCiAgICB0cnkgewogICAgICBpZiAoIXRhcmdldCEuZmlsZXMgfHwgdGFyZ2V0LmZpbGVzLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgdGhyb3cgJ1lvdSBtdXN0IHNlbGVjdCBhbiBpbWFnZSB0byB1cGxvYWQuJwogICAgICB9CiAgICAgIGxvYWRpbmcgPSB0cnVlCiAgICAgIGxldCB7CiAgICAgICAgZGF0YTogW3thdmF0YXJfdXJsfV0sCiAgICAgICAgZXJyb3I6IHVwZGF0ZUVycm9yCiAgICAgIH0gPSBhd2FpdCB1cGRDdXJyVXNlckF2YXRhcih0YXJnZXQuZmlsZXNbMF0pCgogICAgICBpZiAodXBkYXRlRXJyb3IpIHsKICAgICAgICB0aHJvdyB1cGRhdGVFcnJvcgogICAgICB9CgogICAgICBhdmF0YXJfdXJsID0gYXdhaXQgZ2V0QXZhdGFyKGF2YXRhcl91cmwpCiAgICAgIHByb2ZpbGUudXBkYXRlKChwcm9maWxlKSA9PiAoey4uLnByb2ZpbGUsIGF2YXRhcl91cmx9KSkKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIGhhbmRsZUFsZXJ0KHt0eXBlOiAnZXJyb3InLCB0ZXh0OiBlcnJvci5tZXNzYWdlfSkKICAgIH0gZmluYWxseSB7CiAgICAgIGxvYWRpbmcgPSBmYWxzZQogICAgfQogIH0KCiAgb25Nb3VudChnZXRQcm9maWxlKQoKICBsZXQgaXNNb2RhbE9wZW5lZCA9IGZhbHNlCgogIGZ1bmN0aW9uIHRvZ2dsZU1vZGFsKCkgewogICAgaXNNb2RhbE9wZW5lZCA9ICFpc01vZGFsT3BlbmVkCiAgfQoKICAkOiB1c2VybmFtZSA9ICRwcm9maWxlLnVzZXJuYW1lID8gJHByb2ZpbGUudXNlcm5hbWUgOiB1c2VyID8gdXNlcj8uZW1haWwgOiAnRXhwbG9yZXInCiAgJDogYXZhdGFyX3VybCA9ICRwcm9maWxlLmF2YXRhcl91cmwgPyAkcHJvZmlsZS5hdmF0YXJfdXJsIDogVVJMX0RJQ0VCRUFSICsgdXNlcm5hbWUgKyAnLnN2ZycKCiAgZXhwb3J0IGxldCB1c2VyIC8qIFdoZW4gdXNpbmcgYXBwcm9hY2ggIzMgKGNsaWVudC1zaWRlIHVzZXIgc2Vzc2lvbikgY29tbWVudCB0aGlzIG91dCBhbmQgcmVwbGFjZSBgdXNlcmAgd2l0aCBgKGRvbGxhcil1c2VyYCBpbiB0aGUgdGVtcGxhdGUgKi8K">{
}
</script>

<Seo title="Profile"/>
<div class="flex flex-col justify-center items-center relative">
  <div class="p-2 flex flex-col place-items-center">
    <div class="mt-2">
      <Avatar {loading} on:change={updAvatar} src={avatar_url} title={username}/>
    </div>
  </div>
  <div class="profile-detail my-4" on:click={toggleModal}>
    <h2 class="text-4xl mb-1">Howdie, {username}!</h2>
    <span class="inline-block px-2 py-1 bg-gray-400 text-white rounded-full">
			<ChromeIcon class="inline-block" size="1x"/>
      {$profile.website}
		</span>
    <div class="text-gray-500 text-sm my-1">(click to update)</div>
  </div>


  {#if !user}
    <small>
      You've landed on a protected page. Please <a href="/">log in</a> to view the page's full content
    </small>
  {/if}

  {#if user}
    <div>
      <button
          on:click={signOut}
          class="border bg-gray-500 border-gray-600 text-white px-3 py-2 rounded w-full text-center transition duration-150 shadow-lg"
      >
        Sign Out
      </button>
    </div>

    <div class="rounded-md shadow-2xl bg-green-800 w-3/5 overflow-hidden mt-4">
      <h3 class="px-2 py-1 text-white">User from Supabase</h3>
      <pre
          class="bg-gray-800 text-white px-4 py-2 w-full inline-block overflow-auto">{JSON.stringify(
        user,
        null,
        2
      )}</pre>
    </div>
  {/if}
</div>

{#if isModalOpened}
  <Modal {toggleModal}>
    <h2 class="text-3xl my-4">Update Profile</h2>
    <hr class="my-4"/>
    <div class="">
      <div class="mb-4">
        <label for="username" class="block text-green-100 mb-2 text-left">Username</label>
        <input
            id="username"
            name="username"
            type="text"
            class="h-12 px-4 py-2 bg-white rounded shadow-inner border-gray-300 w-full border  hover:border-gray-400 text-gray-700"
            placeholder="Your Username"
            required
            bind:value={profileState.username}
        />
      </div>
      <div class="mb-4">
        <label for="website" class="block text-green-100 mb-2 text-left">Website</label>
        <input
            id="website"
            name="website"
            type="website"
            class="h-12 px-4 py-2 bg-white rounded shadow-inner border-gray-300 w-full border hover:border-gray-400 text-gray-700"
            placeholder="Your website"
            bind:value={profileState.website}
        />
      </div>
    </div>
    <button class="px-6 py-3 bg-green-200 text-gray-800" on:click={updProfile}
    >Update Profile
    </button
    >
  </Modal>
{/if}
